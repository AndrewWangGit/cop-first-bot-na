var delay,keyword,color,category,size,anySize,qty,link="",supremeURL="https://www.supremenewyork.com/shop/all/",i=0,goodSizes=[],goodQty=[],goodAnySizes=[],links=[];function detectDrop(){$.ajax({type:"GET",url:supremeURL,success:function(e){link=(link=(link=e.toLowerCase()).substring(link.indexOf('<li><div class="inner-article">'))).substring(0,link.lastIndexOf("</a></div></div></li>")+21),i++,link.includes(keyword[0])?(document.getElementsByTagName("p")[0].textContent="Drop Detected! Collecting Link(s)!",populateArrays()):(document.getElementsByTagName("p")[0].textContent="Attempt "+i,setTimeout(detectDrop,delay))}})}function populateArrays(){for(i=0;i<keyword.length;i++)supremeURL="https://www.supremenewyork.com/shop/all/"+category[i],$.ajax({async:!1,type:"GET",url:supremeURL,success:function(e){isGoodLink(link=getItemLink(link=e.toLowerCase(),keyword[i],color[i]),category[i])&&(links.push("https://www.supremenewyork.com"+link),goodSizes.push(size[i]),goodQty.push(qty[i]),goodAnySizes.push(anySize[i]))}});openLinks()}function openLinks(){chrome.storage.sync.set({size:goodSizes,qty:goodQty,anySize:goodAnySizes,links:links},function(){window.open(links[0],"_self")})}function isGoodLink(e,s){return!(!e.includes(s)&&!e.includes("tops-sweaters"))}function getItemLink(e,s,n){if(-1==e.indexOf(s))return"invalid input";for(;e.substring(0,e.indexOf(s)).lastIndexOf('class="product-style"')>e.substring(0,e.indexOf(s)).lastIndexOf('class="product-name"');)e=e.substring(e.indexOf(s)+1);if(e=e.substring(e.indexOf(s)),""==n)e=(e=e.substring(e.indexOf("href=")+6)).substring(0,e.indexOf(">")-1),alert(e);else{for(;-1==e.substring(0,e.indexOf(n)).lastIndexOf('class="product-style"')||e.substring(0,e.indexOf(n)).lastIndexOf('class="product-style"')<e.substring(0,e.indexOf(n)).lastIndexOf('class="product-name"');)e=e.substring(e.indexOf(n)+1);e=(e=(e=e.substring(0,e.indexOf(n))).substring(0,e.lastIndexOf('"'))).substring(e.lastIndexOf("href=")+6)}return e}chrome.storage.sync.get(["keyword","color","category","size","anySize","qty","searchInterval"],function(e){keyword=e.keyword,color=e.color,category=e.category,supremeURL+=category[0],size=e.size,anySize=e.anySize,qty=e.qty,delay=void 0===e.searchInterval?2e3:1e3*e.searchInterval,detectDrop()});

function addMoreItems(){var t=1;$("#add").click(function(){$("#dynamic_field").append('<tr id="row'+t+'"><td><div class="special-container"><p class="special-title">Make this my active Proxy</p><input type="radio" id="active" name="active" value="'+t+'"></div></td><td><input class="title eyenput" type="text" name="title" id="title'+t+'" placeholder="title" autocomplete="off" /><input class="ip eyenput" type="text" name="ip" id="ip'+t+'" placeholder="ip" autocomplete="off" /></td><td><input class="port eyenput" type="text" name="port" id="port'+t+'" placeholder="port" autocomplete="off" /><input class="authentication eyenput" type="text" name="authentication" id="authentication'+t+'" placeholder="username:password" autocomplete="off" /></td><td class="center-btn"><button name="remove" id="'+t+'" class="btn btn-danger btn_remove">Remove proxy</button></td></tr>'),t++}),$(document).on("click",".btn_remove",function(){var e=$(this).attr("id");$("#row"+e).remove(),t--}),$(document).on("click",".togglebtn",function(){var e=$(this).attr("id");"Any Size: OFF"==$("#"+e).val()?$("#"+e).val("Any Size: ON"):$("#"+e).val("Any Size: OFF")})}function populateItems(){var t,n=[],a=[],o=[],s=[],l="";chrome.storage.sync.get(["titles","ips","ports","authentications","selectedProxy"],function(e){for(void 0!==e.titles&&(n=e.titles,t=n.length),a=e.ips,o=e.ports,s=e.authentications,l=e.selectedProxy,i=0;i<t-1;i++)document.getElementById("add").click();for(i=0;i<t;i++)document.getElementsByClassName("title")[i].value=n[i],document.getElementsByClassName("ip")[i].value=a[i],document.getElementsByClassName("port")[i].value=o[i],document.getElementsByClassName("authentication")[i].value=s[i];void 0!==e.selectedProxy?$("input[value="+l+"]").prop("checked",!0):$("input[value=none]").prop("checked",!0)})}document.getElementsByClassName("help")[0].addEventListener("click",function(){window.open("https://www.copfirst.com/pages/help#proxy")}),document.getElementById("save").addEventListener("click",function(){var e=[],t=[],n=[],a=[],o="",s=document.getElementsByClassName("title").length;for(i=0;i<s;i++)e.push(document.getElementsByClassName("title")[i].value.trimRight().trimLeft()),t.push(document.getElementsByClassName("ip")[i].value.trimRight().trimLeft()),n.push(document.getElementsByClassName("port")[i].value.trimRight().trimLeft()),a.push(document.getElementsByClassName("authentication")[i].value.trimRight().trimLeft());var l=$("input[name=active]:checked").val();if("none"!=l)var c={mode:"fixed_servers",rules:{singleProxy:{scheme:"http",host:document.getElementById("ip"+l).value,port:parseInt(document.getElementById("port"+l).value)}}};else c={mode:"direct"};if(null!=document.getElementById("authentication"+l)&&null!=document.getElementById("authentication"+l).value&&""!=document.getElementById("authentication"+l).value){o=document.getElementById("authentication"+l).value,username=o.substring(0,o.indexOf(":")),password=o.substring(o.indexOf(":")+1);var u=3;chrome.proxy.settings.set({value:c,scope:"regular"},function(){chrome.webRequest.onAuthRequired.addListener(function(){if(--u<0)return{cancel:!0}})})}else chrome.proxy.settings.set({value:c,scope:"regular"});chrome.storage.sync.set({titles:e,ips:t,ports:n,authentications:a,selectedProxy:l},function(){alert("Proxies have been successfully saved and updated!")})}),$(document).ready(function(){addMoreItems(),populateItems()});
